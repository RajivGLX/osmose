<div class="wrapper-component">
    <div class="container-informations">

        <div class="header-informations">
            <div>
                <h4 class="title-utilisateurs">Modification profil administrateur</h4>
                <span class="undertitle">Les champs obligatoires sont marqués d’un astérisque (*)</span>
            </div>
            
        </div>
        <div class="container-form-user">
            <form [formGroup]="update_admin_form" [ngClass]="loadingAdmin() ? 'visibility-off' : ''">
                <div class="form-line first d-flex">
                    <div class="wrapper-input">
                        <mat-form-field appearance="outline">
                            <mat-label>Nom</mat-label>
                            <input type="text" matInput formControlName="lastname">
                            <mat-error>{{ errors.lastname }}</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="wrapper-input">
                        <mat-form-field appearance="outline">
                            <mat-label>Prénom</mat-label>
                            <input type="text" matInput formControlName="firstname">
                            <mat-error>{{ errors.firstname }}</mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="form-line d-flex" [formGroup]="email_form">
                    <div class="wrapper-input full">
                        <mat-form-field appearance="outline">
                            <mat-label>E-mail du compte</mat-label>
                            <input type="text" matInput formControlName="current_email" readonly>
                            <mat-error>{{ errors.current_email }}</mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="d-flex flex-wrap">
                    <div class="form-line d-flex w-100" [formGroup]="email_form">
                        <div class="wrapper-input">
                            <mat-form-field appearance="outline">
                                <mat-label>Nouvelle adresse email de communincation</mat-label>
                                <input type="text" matInput formControlName="new_email">
                                <mat-error>{{ errors.new_email }}</mat-error>
                            </mat-form-field>
                        </div>
                        <div class="wrapper-input">
                            <mat-form-field appearance="outline">
                                <mat-label>Confirmation</mat-label>
                                <input type="text" matInput formControlName="confirm_new_email">
                                <mat-error>{{ errors.confirm_new_email }}</mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    @if (email_form.invalid && email_form.hasError('confirmEqual')) {
                        <div class="custom-error text-center ">
                            <mat-error>{{ errors.email }}</mat-error>
                        </div>
                    }
                </div>
                <div class="form-line d-flex" [formGroup]="password_form">
                    <div class="wrapper-input full">
                        <mat-form-field appearance="outline">
                            <mat-label>Mot de passe actuel</mat-label>
                            <input [type]="hide ? 'password':'text'" matInput formControlName="current_password">
                            <button mat-icon-button matSuffix (click)="hide = !hide">
                                <mat-icon>{{ hide ? 'visibility_off' : 'visibility' }}</mat-icon>
                            </button>
                            <mat-error>{{ errors.current_password }}</mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="form-line d-flex w-100" [formGroup]="password_form">
                    <div class="wrapper-input">
                        <mat-form-field appearance="outline">
                            <mat-label>Nouveau mot de passe</mat-label>
                            <input [type]="hide ? 'password':'text'" matInput formControlName="new_password">
                            <button mat-icon-button matSuffix (click)="hide = !hide">
                                <mat-icon>{{ hide ? 'visibility_off' : 'visibility' }}</mat-icon>
                            </button>
                            <mat-error>{{ errors.new_password }}</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="wrapper-input">
                        <mat-form-field appearance="outline">
                            <mat-label>Confirmation nouveau mot de passe</mat-label>
                            <input [type]="hide ? 'password':'text'" matInput formControlName="confirm_new_password">
                            <button mat-icon-button matSuffix (click)="hide = !hide">
                                <mat-icon>{{ hide ? 'visibility_off' : 'visibility' }}</mat-icon>
                            </button>
                            <mat-error>{{ errors.confirm_new_password }}</mat-error>
                        </mat-form-field>
                    </div>
                </div>
                @if (password_form.invalid) {
                    <div class="custom-error   text-center">
                        <mat-error>{{ errors.password }}</mat-error>
                    </div>
                }
            </form>
            @if (loadingAdmin()) {
                <div class="loader-form">
                    <app-loader></app-loader>
                </div>
            }
        </div>

        @if (update_admin_form.valid) {
            <div class="wrapper-btn d-flex justify-content-end mt-3">
                <button class="btn custom-btn full" (click)="sendUpdateUserData()">Confirmer les modifications</button>
            </div>
        } @else {
            <div class="wrapper-btn d-flex justify-content-end mt-3 ">
                <button class="btn custom-btn full disabled">Confirmer les modifications</button>
            </div>
        }

    </div>
</div>